<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Ręczna Korekta Stanu Gry</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { color: #d32f2f; }
        fieldset { border: 1px solid #ccc; padding: 20px; margin-bottom: 20px; background: #f9f9f9; }
        legend { font-size: 1.2em; font-weight: bold; padding: 0 10px; }
        select, button, input {
            padding: 10px; margin-top: 5px; border: 1px solid #ccc; 
            border-radius: 4px; width: 100%; box-sizing: border-box; 
        }
        button { background-color: #d32f2f; color: white; cursor: pointer; font-size: 1.1em; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: 1 / -1; }
        label { font-weight: bold; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>
    <h1>Ręczna Korekta Stanu Gry</h1>
    <p>Użyj tego formularza, aby manualnie zastosować efekty kart (np. "Test Człowieczeństwa") lub skorygować błędy. Wprowadź tylko te wartości, które chcesz zmienić (np. '1' aby dodać 1, '-2' aby odjąć 2). Pozostaw puste pola, których nie zmieniasz.</p>
    <p><a href="{{ url_for('index') }}">&larr; Wróć do Głównej Gry</a></p>

    <form method="POST" action="{{ url_for('apply_override') }}">
        <fieldset>
            <legend>1. Wybierz Gracza</legend>
            <select id="player_name" name="player_name" required>
                <option value="">-- Wybierz Gracza --</option>
                {% for name in player_names %}
                    <option value="{{ name }}">{{ name }}</option>
                {% endfor %}
            </select>
        </fieldset>

        <fieldset>
            <legend>2. Zmień Punkty Zwycięstwa (VP)</legend>
            <div class="grid">
                <div>
                    <label for="victory_points">Punkty Zwycięstwa:</label>
                    <input type="number" id="victory_points" name="victory_points" placeholder="np. 1 lub -1">
                </div>
            </div>
        </fieldset>

        <fieldset>
            <legend>3. Zmień Zasoby</legend>
            <div class="grid">
                <div>
                    <label for="solari">Solari:</label>
                    <input type="number" id="solari" name="solari" placeholder="np. 2 lub -1">
                </div>
                <div>
                    <label for="Spice">Przyprawa (Spice):</label>
                    <input type="number" id="Spice" name="Spice" placeholder="np. 2 lub -1">
                </div>
                <div>
                    <label for="water">Woda:</label>
                    <input type="number" id="water" name="water" placeholder="np. 2 lub -1">
                </div>
            </div>
        </fieldset>

        <fieldset>
            <legend>4. Zmień Wojsko</legend>
             <div class="grid">
                <div>
                    <label for="troops_garrison">Garnizon (Garrison):</label>
                    <input type="number" id="troops_garrison" name="troops_garrison" placeholder="Dodaj lub odejmij">
                </div>
                <div>
                    <label for="troops_in_conflict">W Konflikcie (Conflict):</label>
                    <input type="number" id="troops_in_conflict" name="troops_in_conflict" placeholder="Dodaj lub odejmij">
                </div>
            </div>
        </fieldset>

        <fieldset>
            <legend>5. Zmień Wpływy (Frakcje)</legend>
            <div class="grid">
                <div>
                    <label for="faction_emperor">Imperator:</label>
                    <input type="number" id="faction_emperor" name="faction_emperor" placeholder="np. 1 lub -1">
                </div>
                 <div>
                    <label for="faction_guild">Gildia:</label>
                    <input type="number" id="faction_guild" name="faction_guild" placeholder="np. 1 lub -1">
                </div>
                 <div>
                    <label for="faction_fremen">Fremeni:</label>
                    <input type="number" id="faction_fremen" name="faction_fremen" placeholder="np. 1 lub -1">
                </div>
                 <div>
                    <label for="faction_bene_gesserit">Bene Gesserit:</label>
                    <input type="number" id="faction_bene_gesserit" name="faction_bene_gesserit" placeholder="np. 1 lub -1">
                </div>
            </div>
        </fieldset>


        <fieldset>
            <legend>6. Dodaj Kartę Intrygi Graczowi</legend>
            <div class="grid">
                <div>
                    <label for="add_intrigue_id">Dodaj Intrygę:</label>
                    <select id="add_intrigue_id" name="add_intrigue_id">
                        <option value="">-- Wybierz, by dodać --</option>
                        {% for intrigue_id, intrigue_data in all_intrigues.items() %}
                            <option value="{{ intrigue_id }}">{{ intrigue_data.name }} ({{ intrigue_data.type }})</option>
                        {% endfor %}
                    </select>
                    <p style="font-size: 0.8em; color: #555;">(Pamiętaj, aby wybrać gracza w sekcji 1. Usunięcie intrygi wymaga edycji JSON.)</p>
                </div>
            </div>
        </fieldset>

        <fieldset>
            <legend>7. Ustaw Bonus Przyprawy na Polach (Globalne)</legend>
            <p>Uwaga: Ta wartość <b>zastąpi</b> obecną, a nie doda się. Wpływa na całą grę, nie na wybranego gracza.</p>
            <div class="grid">
                <div>
                    <label for="bonus_the_greate_flat">The Great Flat (Bonus):</label>
                    <input type="number" id="bonus_the_greate_flat" name="bonus_the_greate_flat" value="{{ current_bonuses.the_greate_flat }}" min="0">
                </div>
                <div>
                    <label for="bonus_hagga_basin">Hagga Basin (Bonus):</label>
                    <input type="number" id="bonus_hagga_basin" name="bonus_hagga_basin" value="{{ current_bonuses.hagga_basin }}" min="0">
                </div>
                <div>
                    <label for="bonus_imperial_basin">Imperial Basin (Bonus):</label>
                    <input type="number" id="bonus_imperial_basin" name="bonus_imperial_basin" value="{{ current_bonuses.imperial_basin }}" min="0">
                </div>
            </div>
        </fieldset>


        <button type="submit" onclick="return confirm('Czy na pewno chcesz ręcznie zmodyfikować stan gry?')">Zastosuj Korektę</button>
    </form>
</body>
</html>